New Methods for Ligand-Based Virtual Screening: Use of Data Fusion and Machine Learning to Enhance the Effectiveness of Similarity Searching J


e´roˆme Hert, Peter Willett,* and David J. Wilton

INTRODUCTION Similarity searching is perhaps the simplest tool available for ligand-based virtual screening of chemical databases, requiring just a single known bioactive molecule, the reference or target structure, as the starting-point for a database search.1 The traditional approach to similarity searching, first described by Carhart et al.2 and Willett et al.,3 involves comparing the reference structure with each of the database structures in turn, computing a quantitative measure of structural similarity in each case, and then returning the most similar molecules, the nearest neighbors (NNs), as the output from the search. The similar property principle states that structurally similar molecules are likely to have similar properties, and the nearest neighbors of a bioactive reference structure are hence also expected to exhibit this activity.4 There is considerable evidence to suggest that this is, indeed, often the case in practice,5-10 albeit with exceptions to this general rule.11 Many types of similarity measure have been discussed in the literature,1,12-14 but by far the most common involves the use of a simple association coefficient, normally the Tanimoto coefficient, with a 2D fragment bit-string representation of molecular structure. We have recently described two approaches that can enhance the effectiveness of virtual screening based on such similarity measures. First, we described the use of group fusion (vide infra) when not one but several bioactive reference structures are available.15-17 Second, we have recently shown how nearest-neighbor information and group fusion can be used even when only the conventional, single reference structure is available, an approach that we refer to as turbo similarity searching (TSS)18 and that involves the assumption that the nearest neighbors of a bioactive reference structure are also active. In this paper, we report further developments of these two approaches. In the next section, we discuss the suitability of group fusion for scaffold-hopping applications.19 Scaffold-hopping (other names that have been used include leapfrogging, lead hopping, and scaffold searching) involves finding chemical structures that exhibit the same biological activity but that have significant topological differences. The identification of such nonclassical bioisosteres20 has occasioned much interest in recent years, as it provides ways of enhancing the pharmacological properties of known leads and of entering unpatented portions of chemical space.21-26 We then report a development of turbo similarity searching that again utilizes information about the nearest neighbors of a reference structure but that here enables the use of machine-learning techniques for virtual screening without the need for an explicit training set of known active and known inactive molecules; we again focus on the use of these methods for scaffold-hopping applications. In both cases, we have evaluated the effectiveness of the approaches using simulated virtual screening searches on the MDL Drug Data Report (MDDR) database.27 After removal of duplicates and molecules that could not be processed using local software, the version of the file used here contained a total of 102 514 molecules. Searches were then carried out for molecules belonging to specific activity classes (the selection of which is discussed further below) and the success of a search determined by the extent to which it was possible to retrieve molecules exhibiting the required activity. Fuller details of all of the experiments reported here are presented by Hert.28Data fusion (or consensus scoring) involves combining the results of different similarity searches of a chemical database.29,30 The normal approach to data fusion, called similarity fusion, involves carrying out searches with a single reference structure but using multiple similarity measures. For example, one might combine searches for a specific reference structure that had been carried out with several different types of fingerprints or of similarity coefficients.17 Group fusion, conversely, involves carrying out searches with a single similarity measure but using multiple reference structures. Specifically, assume that some database structure i yields similarity scores (Tanimoto coefficient values in our experiments) of s1, s2, ..., sn with n different reference structures; then, we have shown that effective searches are obtained by ranking the database molecules on the basis of the maximum of these scores, that is, max{s1, s2...si...sn-1, sn}; we refer to this as the MAX fusion rule.15 Our initial experiments (as detailed in ref 15) involved searches for 11 MDDR activity classes that had been chosen from the database such that the mode of action is known, the activity is of current pharmaceutical interest, and there is a substantial number of MDDR molecules categorized as exhibiting that activity. The data sets chosen were quite disparate in nature, some of them being structurally homogeneous (e.g., rennin and HIV-1 protease inhibitors) while others were structurally diverse (e.g., cyclooxygenase and protein kinase C inhibitors); the diversity was estimated by the mean pairwise similarity (hereafter, MPS) across each set of active molecules. Hardly surprisingly, it was found that the search effectiveness increased broadly in line with this mean self-similarity; however, acceptable results were obtained even with the more heterogeneous activity classes.15 Subsequent experiments using data sets from both MDDR and the Dictionary of Natural Products31 suggested that, while the absolute level of performance might not be very high for such data sets, the increase in performance, relative to conventional similarity searching based on just a single reference structure, was greatest for the most diverse activity classes.17 These experiments suggest that group fusion may be of greatest value in those cases where conventional similarity searching (and conventional similarity fusion) is least effective, that is, that it might prove to be a useful tool for scaffold hopping. We have hence carried out further experiments to test the generality of this observation; to this end, we have identified MDDR activity classes that, while satisfying the criteria mentioned above, additionally are as structurally diverse as possible. One could use trained medicinal chemists to comment on the diversity of a set of molecules, but human judgment is known to be highly variable;32,33 instead, we have again used the MPS, when averaged over all of the pairs of molecules within a specific MDDR activity class, to quantify the diversity. This is easy to compute and has been shown to give results that mirror those obtained with algorithmic scaffold definitions.18 The MPS requires a similarity measure to be defined, that is, a coefficient (the Tanimoto coefficient in this case) and a structural representation, so that the individual intermolecular structural similarities can be computed. In our initial study of group fusion,15 we used just a single descriptor (Unity 2D fingerprints34) to assess the diversities of the activity classes that were used. To ensure the generality of our results and to remove any unintended bias, we have here used multiple descriptors to choose the most diverse activity classes. Specifically, we have computed the MPS using the Tanimoto coefficient and the following types of 2D fingerprints: one structural-key fingerprint [the 1052-bit Barnard Chemical Information (BCI) fingerprints; three hashed fingerprints, 2048-bit Daylight, 988-bit Unity, and 2048-bit Avalon fingerprints]; four circular substructure fingerprints (ECFP_2, ECFP_4, FCFP_2, and FCFP_4 from Scitegic Inc.); and two pharmacophore representations (Similog and CATS). These fingerprints and their implementation are described by Hert et al.16 The local version of the MDDR database contains 707 different activity classes. Of these, we considered only the 309 activity classes that were covered in a ligand ontology linking the activity classes to a hierarchical classification of protein targets.35 A total of 48 of these 309 classes had less than two members in our file, and the MPS was then computed for each of the remaining 261 activity classes, using each of the 10 different types of fingerprints listed above. The final MPS for each class was then taken as the mean when averaged over the values for the individual fingerprint types, and the 10 most diverse (lowest average MPS) classes were selected, subject to them containing at least 50 compounds. These activity classes are listed in Table 1a; only one of them, the cyclooxygenase inhibitors, had figured in our previous experiments. For comparison with the MPS values in this table, the MPS for 10 000 compounds selected at random from MDDR was 0.200, demonstrating the highly disparate natures of the data sets listed in Table 1a. In addition, 10 activity classes were similarly selected that had medium average MPS values and a further 10 that had the highest average MPS values (i.e., very homogeneous sets of compounds), as detailed in parts b and c of Table 1, respectively. Simulated virtual screening searches were carried out on the MDDR database using the procedures described in our previous papers.15-18 A set of 10 molecules was picked at random from an activity class. A similarity search of the database was carried out for each selected active, and the 10 resulting sets of similarity scores were combined using the MAX fusion rule to give the output from the search. The procedure was then repeated using nine further sets of reference structures, and in each search, a note was made of the recall, that is, the percentage of the active molecules (i.e., those in the same class as those in the reference set) that occurred in the top 5% of the ranking resulting from the group fusion search; the mean recall was then calculated when averaged over these 10 group fusion searches. The procedure was repeated over each of the 30 chosen activity classes (10 high diversity, 10 medium diversity, and 10 low diversity as detailed in Table 1) and the mean recall calculated when averaged over the 10 activity classes of each type. The whole procedure was repeated for each of the 10 different types of fingerprint. The results of these runs are summarized in Table 2. This table also contains the results for conventional similarity searches, that is, when just a single reference structure is used (with the results in the left-hand portion of the table being the mean values when averaged over similarity searches based on all of the active molecules in each of the chosen classes), and for searches using binary kernel discrimination (BKD; vide infra). Two conclusions may be drawn from the results in Table 2. First, it is clear that the fingerprints based on circular substructures are the most effective of those tested here in the group fusion experiments, with the best performance being obtained across the various types of activity class with the ECFP_2 and ECFP_4 fingerprints from Scitegic’s Pipeline Pilot system.36 This result is in line with our previous study,16 which considered just 11 activity classes spanning a range of levels of diversity. The second conclusion that can be drawn, and the one that is of importance in the context of scaffold hopping, is the effectiveness of group fusion when used with the high-diversity (low MPS score) data sets. As would be expected, the absolute recall values for these searches are much lower than those for the medium-MPS and high-MPS searches; however, the recall values relative to those for conventional similarity searching are much higher, more than doubling the numbers of retrieved actives for most of the fingerprint types. It may be argued that merely doubling the recall is rather disappointing given that 10 times as many structures are being used as input to the search algorithm. However, there is likely to be at least some structural redundancy in any set of reference structures; moreover, in many cases, even conventional similarity searching with a single reference structure can retrieve a significant fraction of the total actives, and there is hence only a limited number of additional actives available for retrieval. It is hence most unlikely that one can achieve a linear increase in recall commensurate with the number of reference structures.
