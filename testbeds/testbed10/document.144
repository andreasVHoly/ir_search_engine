Machine learning regression algorithms for biophysical parameter retrieval: Opportunities for Sentinel-2 and -3

Jochem Verrelst, , Jordi Muñoz, Luis Alonso, Jesús Delegido, Juan Pablo Rivera, Gustavo Camps-Valls, José Moreno

1. Introduction
The lifetime of current Earth Observation (EO) sensors such as Landsat 5/7 and SPOT-5 is coming to an end. Any gap in data availability would affect on-going monitoring programs. To guarantee the availability of data to service providers and users, Global Monitoring for Environment and Security (GMES) took the initiative to a new generation of environmental Earth Observation missions, the so-called Sentinel missions (Martimort et al., 2007). GMES is a joint initiative of the European Commission and the European Space Agency (ESA), founded to establish a European capacity for the provision and use of operational monitoring information from space for environment and security applications (http://www.gmes.info).

Five different Sentinel concepts have been planned. In particular, Sentinel-2 (S2) and Sentinel-3 (S3) are designed to provide continuity to monitoring services over global terrestrial surfaces by relying on superspectral (more than ten and less than 50 bands, i.e. in-between multispectral and hyperspectral resolution) high resolution (S2) and medium resolution (S3) observations. At the same time, further improvements of existing monitoring services from space is needed to better understand the environment dynamics at local and global scales (Hilker et al., 2008). Therefore, along with these new missions, there is a demand of enhanced operational retrieval strategies of relevant biophysical parameters (Martimort et al., 2007).

Leaf chlorophyll content (Chl), green leaf area index (LAI) and fractional vegetation cover (FVC) are among the most important biophysical parameters retrievable from satellite reflectance data ( Lichtenthaler, 1987 and Whittaker and Marks, 1975). These parameters give insight in the phenological stage and health status (e.g., development, productivity, stress) of crops and forests. Chl can be considered a bio-indicator of the plant's actual health status ( Lichtenthaler et al., 1996 and Sampson et al., 2003),and of vegetation gross primary productivity (Gitelson et al., 2006). Besides, LAI and FVC characterize the structure and functioning of vegetation cover (Hirose et al., 1997). Because of its role as the interface between ecosystem and atmosphere and involvement in many processes, Chl, FVC and LAI are crucial in aboveground biomass estimation, vegetative evapo-transpiration calculation and the energy-exchange evaluation of terrestrial vegetation ( Baret and Guyot, 1991, Bicheron and Leroy, 1999, Buermann et al., 2001 and Kakani et al., 2003).

When it comes to the implementation of candidate retrieval methods into operational Sentinel data processing chains, it is mandatory to invest in models that are both accurate and robust. The GMES objective for near real-time delivery requires that the dependency on ancillary data should be kept to the minimum (Martimort et al., 2007). Simple, yet widely accepted, empirical methods such as those based on vegetation indices, red-edge position, or spectral integral approaches are prone to perform unstable when applied to images which differ from those where the method was designed for (Verrelst et al., 2010). Conversely, despite being effective in local campaigns, physically-based methods such as inverting a radiative transfer (RT) model require site-specific information for proper model parameterization, which is not always instantly available. Hence, in view of monitoring applications across the globe, methods based on vegetation indices may be too simplistic while physical models may be too cumbersome for delivering near real-time and accurate products (Baret & Buis, 2008).

Alternatively, machine learning regression algorithms have the potential to generate adaptive, robust relationships and, once trained, they are very fast to apply (Hastie et al., 2009). Typically, machine learning methods are able to cope with the strong nonlinearity of the functional dependence between the biophysical parameter and the observed reflected radiance (e.g. Knudby et al. (2010)). They may therefore be more suitable candidates for operational applications. Effectively, algorithms such as neural networks (NNs) are already implemented in operational retrieval chains (e.g. Schiller and Doerffer, 2005, Pozdnyakov et al., 2005, Verger et al., 2008 and Verger et al., 2011). It remains nevertheless to be questioned whether NNs offer the most flexible tools for parameter estimation, gaining insights in the retrievals and evaluating retrieval performances. Besides, training NNs involve tuning several parameters that may greatly impact the final robustness of the model. In part, this is why in the recent years, NNs are being replaced by more advanced, simpler to train regression methods. Specifically, during the last two decades, the family of kernel methods ( Camps-Valls & Bruzzone, Dec, 2009) has emerged as an alternative to NNs in many scenarios. Kernel methods typically involve few and intuitive hyperparameters to be tuned, and can perform flexible input–output nonlinear mappings. In this work, we test the capabilities of four state-of-the-art machine learning regression algorithms given different S2 and S3 band settings: i) neural networks (Haykin, 1999), ii) support vector regression (Smola & Schölkopf, 2004), iii) kernel ridge regression (Shawe-Taylor & Cristianini, 2004), and iv) Gaussian processes regression (Rasmussen & Williams, 2006). The methods are compared in terms of accuracy, goodness of fit, robustness to low sample sized scenarios, and computational cost. The data used for the experiments came from the ESA-led field campaign SPARC, http://www.uv.es/leo/sparc/, which took place on the agricultural test site Barrax, Spain.

This setting brings us to the following main objective of the work: evaluation of the four machine learning regression algorithms on their ability to spectrally assess biophysical parameters given simulated S2 and S3 data. The potential use of the best algorithm will be further discussed for implementation in operational processing chains for monitoring services.

7. Summary and conclusions
ESA's forthcoming Sentinel-2 (S2) and Sentinel-3 (S3) satellites aim to improve the old generation of satellite sensors by providing superspectral imagery of high spatial and temporal resolution. S2 will be configured with band settings according to Landsat and SPOT, while S3 will include OLCI, which is a sensor similar to MERIS, in both cases with enhanced capabilities in terms of spatial and temporal resolution. Moreover, both Sentinels will be equipped with additional new bands for improved retrieval capacities and compensation of atmospheric effects. Along with these enhanced sensor configurations, there is also a need for improved parameter retrieval methods implementable into operational processing chains. In this respect, we have compared the utility of four state-of-the-art machine learning regression algorithms in estimating three key biophysical parameters Chl, LAI and FVC from satellite reflectance measurements in the range of 400–1000 nm. Field data came from the Barrax test site, covering a broad range of crops and growing stages. Hyperspectral CHRIS data was used for the simulation of the following S2 and S3 configurations: S2-10 m (4 bands), S2-20 m (8 bands), S2-60 m (10 bands), and S3-300 m (19 bands). GPR not only yielded better accuracies for the majority of cases, but also proved to be a fast and robust regressor. Despite that with S2 more bands can be included at lower spatial resolution, it was found that LAI and FVC can be accurately mapped with four bands at highest spatial resolution of 10 m. Chl benefited from extra bands in the red-edge for reaching best estimates. Specifically, Chl reached RMSE accuracies on the order of the by GMES requested precision threshold of 10%. In addition to high accuracies, GPR provide a confidence value (predictive variance) along with a mean predictive estimation, and insight in relevant bands thanks to the optimization of tailored kernel function. The latter revealed that parameter covariance contains an important source of information. GPR is concluded as a promising candidate for implementation into operational Sentinel processing chains.
